(function(window){'use strict';function fitRowsDefinition(LayoutMode){var FitRows=LayoutMode.create('fitRows');FitRows.prototype._resetLayout=function(){this.x=0;this.y=0;this.maxY=0;this.row=0;this.rows=[];this._getMeasurement('gutter','outerWidth');if(this.options.equalheight){for(var i=0;i<this.isotope.items.length;i++){this.isotope.items[i].css({height:'auto'});}}};FitRows.prototype._getItemLayoutPosition=function(item){item.getSize();var itemWidth=item.size.outerWidth;var containerWidth=Math.ceil(this.isotope.size.innerWidth+1);if(this.x!==0&&itemWidth+this.x>containerWidth){this.x=0;this.y=this.maxY;}
if(this.x==0&&this.y!=0){this.row++;}
var position={x:this.x,y:this.y};this.maxY=Math.max(this.maxY,this.y+item.size.outerHeight);this.x+=itemWidth;if(typeof this.rows[this.row]=='undefined'){this.rows[this.row]=[];this.rows[this.row].start=this.y;this.rows[this.row].end=this.maxY;}
else{this.rows[this.row].end=Math.max(this.rows[this.row].end,this.maxY);}
item.row=this.row;return position;};FitRows.prototype._equalHeight=function(){for(var i=0;i<this.isotope.items.length;i++){var row=this.isotope.items[i].row,data=this.rows[row];if(data){var height=data.end-data.start;height-=this.isotope.items[i].size.borderTopWidth+this.isotope.items[i].size.borderBottomWidth;height-=this.isotope.items[i].size.marginTop+this.isotope.items[i].size.marginBottom;height-=this.gutter.height||0;if(this.isotope.items[i].size.isBorderBox==false){height-=this.isotope.items[i].size.paddingTop+this.isotope.items[i].size.paddingBottom;}
this.isotope.items[i].size.height=height;this.isotope.items[i].css({height:height.toString()+'px',});}}}
FitRows.prototype._getContainerSize=function(){if(this.options.equalheight){this._equalHeight();}
return{height:this.maxY};};return FitRows;}
if(typeof define==='function'&&define.amd){define(['../layout-mode'],fitRowsDefinition);}else if(typeof exports==='object'){module.exports=fitRowsDefinition(require('../layout-mode'));}else{fitRowsDefinition(window.Isotope.LayoutMode);}})(window);